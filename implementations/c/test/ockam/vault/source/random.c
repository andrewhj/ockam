/**
 ********************************************************************************************************
 * @file    random.c
 * @brief   Ockam Vault common tests for random
 ********************************************************************************************************
 */

/*
 ********************************************************************************************************
 *                                             INCLUDE FILES                                            *
 ********************************************************************************************************
 */

#include <ockam/error.h>
#include <ockam/log.h>
#include <ockam/vault.h>

#include <test_vault.h>

/*
 ********************************************************************************************************
 *                                                DEFINES                                               *
 ********************************************************************************************************
 */

#define TEST_VAULT_RAND_NUM_SIZE                    32u

/*
 ********************************************************************************************************
 *                                               CONSTANTS                                              *
 ********************************************************************************************************
 */

/*
 ********************************************************************************************************
 *                                               DATA TYPES                                             *
 ********************************************************************************************************
 */

/*
 ********************************************************************************************************
 *                                          FUNCTION PROTOTYPES                                         *
 ********************************************************************************************************
 */

/*
 ********************************************************************************************************
 *                                            GLOBAL VARIABLES                                          *
 ********************************************************************************************************
 */

uint8_t g_rand_num[TEST_VAULT_RAND_NUM_SIZE] = {0};


/*
 ********************************************************************************************************
 *                                           GLOBAL FUNCTIONS                                           *
 ********************************************************************************************************
 */

/*
 ********************************************************************************************************
 *                                            LOCAL FUNCTIONS                                           *
 ********************************************************************************************************
 */


/**
 ********************************************************************************************************
 *                                          test_vault_random()
 *
 * @brief   Ensure the specified ockam vault random function can generate a number
 *
 ********************************************************************************************************
 */

void test_vault_random()
{
    OCKAM_ERR err = OCKAM_ERR_NONE;


    err = ockam_vault_random((uint8_t*) &g_rand_num,            /* Generate a random number                           */
                             TEST_VAULT_RAND_NUM_SIZE);
    if(err != OCKAM_ERR_NONE) {
        test_vault_print(OCKAM_LOG_ERROR,
                         "RANDOM",
                         TEST_VAULT_NO_TEST_CASE,
                         "Random number generation failed");
    }

    test_vault_print(OCKAM_LOG_INFO,
                     "RANDOM",
                     TEST_VAULT_NO_TEST_CASE,
                     "Random Number Generation Success");
    test_vault_print_array(OCKAM_LOG_DEBUG,
                           "RANDOM",
                           "Random Number Generation",
                            &g_rand_num[0],
                            TEST_VAULT_RAND_NUM_SIZE);
}

